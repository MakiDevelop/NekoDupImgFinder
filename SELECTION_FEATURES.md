# 🎯 全選功能與批次刪除說明

## ✨ 新增功能概覽

### 🎯 核心功能
- **自動選擇**：掃描完成後自動選擇要刪除的檔案，保留檔案大小最大的版本
- **全選功能**：一鍵選擇所有重複檔案
- **批次刪除**：一次性刪除所有選中的檔案
- **視覺回饋**：清楚顯示選擇狀態和建議保留的檔案

## 🔧 功能詳解

### 1. 自動選擇（保留最大檔案）
```swift
// 掃描完成後自動執行
scanner.autoSelectForDeletion()
```

**運作邏輯：**
- 在每個重複群組中，自動保留檔案大小最大的檔案
- 其餘檔案自動標記為「選中」狀態
- 使用者可以手動調整選擇

### 2. 全選功能
```swift
// 全選所有重複檔案
scanner.selectAllDuplicates()

// 取消全選
scanner.deselectAllDuplicates()

// 群組內全選
group.toggleAllSelection()
```

**操作方式：**
- **全選重複檔案**：選擇所有重複群組中的所有檔案
- **取消全選**：取消所有選擇
- **全選群組**：只選擇當前群組內的檔案

### 3. 批次刪除
```swift
// 刪除所有選中的檔案
await scanner.deleteAllSelectedFiles()

// 刪除特定檔案
await scanner.deleteFiles(selectedFiles)
```

**安全機制：**
- 刪除前顯示確認對話框
- 顯示要刪除的檔案數量
- 操作無法復原的警告

## 🎨 使用者介面

### 批次操作工具列
```
[全選重複檔案] [取消全選] [自動選擇（保留最大）] [刪除選中檔案]
```

### 檔案列表顯示
- ✅ **選擇框**：點擊切換選擇狀態
- 🖼️ **縮圖**：檔案預覽
- 📝 **檔案資訊**：名稱、路徑、大小、日期
- ⭐ **建議標示**：黃色星星標示建議保留的檔案
- 🔵 **選擇標示**：藍色勾選標示已選中的檔案

### 選擇摘要面板
```
📋 選擇摘要
選中檔案: 5
保留檔案: 3
節省空間: 15.2 MB
重複群組: 2

操作建議
• 選中的檔案將被刪除
• 未選中的檔案將被保留
• 建議保留檔案大小最大的版本
```

## 🔄 工作流程

### 1. 掃描階段
1. 選擇目錄開始掃描
2. 系統自動識別重複檔案
3. **自動選擇要刪除的檔案**（保留最大的）

### 2. 選擇階段
1. 檢視自動選擇結果
2. 手動調整選擇（如需要）
3. 使用全選/取消全選功能
4. 查看選擇摘要

### 3. 刪除階段
1. 確認選擇的檔案
2. 點擊「刪除選中檔案」
3. 確認刪除對話框
4. 執行批次刪除

## 🎯 使用場景

### 場景 1：快速清理
1. 掃描完成後，系統自動選擇要刪除的檔案
2. 直接點擊「刪除選中檔案」
3. 確認刪除

### 場景 2：手動調整
1. 檢視自動選擇結果
2. 手動取消選擇某些檔案（不想刪除的）
3. 手動選擇額外的檔案（想要刪除的）
4. 執行刪除

### 場景 3：全選刪除
1. 點擊「全選重複檔案」
2. 點擊「刪除選中檔案」
3. 確認刪除

## 🔒 安全機制

### 確認對話框
```
確定要刪除選中的 5 個檔案嗎？此操作無法復原。
[取消] [刪除]
```

### 檔案保護
- 保留檔案大小最大的版本
- 顯示建議保留的檔案（黃色星星）
- 清楚標示選擇狀態

### 錯誤處理
- 刪除失敗時顯示錯誤訊息
- 部分檔案刪除失敗時繼續處理其他檔案
- 重新掃描以更新結果

## 📊 統計資訊

### 選擇摘要
- **選中檔案數量**：將被刪除的檔案
- **保留檔案數量**：將被保留的檔案
- **節省空間**：刪除後可節省的磁碟空間
- **重複群組數量**：發現的重複群組總數

### CSV 匯出
匯出的 CSV 檔案包含選擇狀態欄位：
```csv
檔案名稱,檔案路徑,檔案大小,建立日期,圖片尺寸,相似類型,選擇狀態
photo1.jpg,/path/to/photo1.jpg,1.2 MB,2024-01-01,1920x1080,完全一致,選中
photo2.jpg,/path/to/photo2.jpg,2.1 MB,2024-01-01,1920x1080,完全一致,未選中
```

## 🎉 功能優勢

### ✅ 效率提升
- 自動選擇減少手動操作
- 批次刪除節省時間
- 一鍵全選快速操作

### ✅ 安全性
- 多重確認機制
- 清楚顯示選擇狀態
- 建議保留最佳版本

### ✅ 使用者體驗
- 直觀的視覺回饋
- 詳細的統計資訊
- 靈活的操作選項

---

**🐱 這個全選功能讓重複圖片的清理變得更加高效和安全！** 